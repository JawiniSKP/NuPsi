version: "3.1"

rules:
  # ——— Reglas básicas ———
  - rule: despedida
    steps:
      - intent: goodbye
      - action: utter_goodbye

  - rule: identidad del bot
    steps:
      - intent: bot_challenge
      - action: utter_iamabot

  # ——— Formulario de perfil de nutrición ———
  - rule: activar formulario perfil nutrición
    steps:
      - intent: ask_meal_planning
      - action: nutrition_profile_form
      - active_loop: nutrition_profile_form

  - rule: enviar formulario perfil nutrición
    condition:
    - active_loop: nutrition_profile_form
    steps:
    - action: nutrition_profile_form
    - active_loop: null
    - action: utter_submit_nutrition_profile_form
    - action: action_propose_meal_plan


  # ——— Fallback (elige UNA estrategia) ———
  # Opción A: Fallback con Gemini (si tienes action_fallback_to_gemini en actions.py y declarada en domain.yml)
  - rule: fallback con gemini
    steps:
      - intent: nlu_fallback
      - action: action_fallback_to_gemini

  # Opción B: Fallback simple (si NO usarás Gemini, comenta la regla de arriba y descomenta esta)
  # - rule: fallback simple
  #   steps:
  #     - intent: nlu_fallback
  #     - action: utter_default
