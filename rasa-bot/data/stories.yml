version: "3.1"
stories:

  #  LGICA AADIDA: Flujo de Afirmaci贸n (El usuario quiere centros de salud)
  - story: Proporcionar lista de centros de salud
    steps:
      - action: action_handle_medical_query 
      - intent: affirm 
      - action: action_provide_health_centers
      - action: action_listen 

  #  LGICA AADIDA: Flujo de Negaci贸n (El usuario NO quiere centros de salud)
  - story: Negaci贸n a la sugerencia de centros de salud
    steps:
      - action: action_handle_medical_query
      - intent: deny 
      - action: utter_thanks 
      
  # --- Historias Existentes (Mantenidas) ---
  - story: happy path
    steps:
      - intent: greet
      - action: utter_greet
      - intent: ask_capabilities
      - action: utter_ask_capabilities
      - intent: thanks
      - action: utter_thanks
      - intent: goodbye
      - action: utter_goodbye

  - story: motivation support
    steps:
      - intent: greet
      - action: utter_greet
      - intent: ask_motivation_support
      - action: utter_ask_motivation_support
      - intent: affirm
      - action: utter_thanks

  - story: user asks about hydration
    steps:
      - intent: greet
      - action: utter_greet
      - intent: ask_hydration
      - action: utter_ask_hydration
      - intent: thanks
      - action: utter_thanks

  - story: user asks about exercise
    steps:
      - intent: greet
      - action: utter_greet
      - intent: ask_exercise_general
      - action: utter_ask_exercise_general
      - intent: ask_cardio_benefits
      - action: utter_ask_cardio_benefits
      - intent: goodbye
      - action: utter_goodbye

  - story: user feels sad
    steps:
      - intent: greet
      - action: utter_greet
      - intent: express_sadness
      - action: utter_express_sadness
      - intent: ask_emotional_support
      - action: utter_ask_emotional_support
      - intent: thanks
      - action: utter_thanks

  - story: user manages anxiety with nutrition
    steps:
      - intent: express_anxiety
      - action: utter_express_anxiety
      - intent: ask_emotional_eating
      - action: utter_ask_emotional_eating
      - intent: ask_healthy_snacks
      - action: utter_ask_healthy_snacks
      - intent: affirm
      - action: utter_thanks

  - story: stress management flow
    steps:
      - intent: express_anxiety
      - action: utter_express_anxiety
      - intent: ask_stress_management
      - action: utter_ask_stress_management
      - intent: thanks
      - action: utter_thanks

  - story: consulta alimento con macronutriente
    steps:
      - intent: ask_specific_food
        entities:
          - macronutrient: prote铆nas
      - slot_was_set:
          - macronutrient: "prote铆nas"
      - action: action_answer_specific_food

  - story: rutina por grupo muscular
    steps:
      - intent: ask_muscle_group
        entities:
          - muscle_group: pecho
      - slot_was_set:
          - muscle_group: "pecho"
      - action: action_propose_workout

  - story: planificaci贸n con formulario
    steps:
      - intent: ask_meal_planning
      - action: nutrition_profile_form
      - active_loop: nutrition_profile_form

  - story: seguimiento de progreso
    steps:
      - intent: ask_progress_tracking
      - action: action_track_progress_tip
      - intent: thanks
      - action: utter_thanks
      
  #  NUEVO STORY: Flujo de Respuesta despu茅s de que el bot pide la ubicaci贸n
  # Nota: El reintento de la acci贸n se maneja en rules.yml.
  # Esta historia es redundante si la regla funciona, pero ayuda al entrenamiento.
  - story: Usuario proporciona ubicaci贸n despu茅s de ser preguntado
    steps:
      - action: action_search_nearby_professional # Se ejecuta (y pide ubicaci贸n)
      - slot_was_set:
          - asked_for_location: True # Se establece el slot de control
      - intent: provide_location # El usuario responde
      - action: action_search_nearby_professional # La regla re-ejecuta la acci贸n
      - slot_was_set:
          - is_searching_professional: null # La acci贸n limpia el slot
      - action: action_listen