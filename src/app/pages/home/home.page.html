<!-- 
  üè† P√ÅGINA PRINCIPAL - HOME PAGE
  P√°gina principal de la aplicaci√≥n NuPsi con seguimiento emocional
-->

<!-- 
  HEADER - Cabecera principal de la aplicaci√≥n
  Contiene el t√≠tulo y botones de navegaci√≥n superior
-->
<ion-header [translucent]="true">
  <ion-toolbar color="primary">
    <ion-title>NutPsi</ion-title>
    <ion-buttons slot="end">
      <!-- CAMBIO: openProfile() ‚Üí openProfileMenu($event) -->
      <ion-button (click)="openProfileMenu($event)">
        <ion-icon slot="icon-only" name="person-circle"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<!-- 
  CONTENIDO PRINCIPAL - √Årea scrollable de la p√°gina
  ion-padding: a√±ade padding interno
  padding-bottom: evita que el contenido quede debajo del men√∫
-->
<ion-content [fullscreen]="true" class="ion-padding" style="--padding-bottom: 80px;">

  <div class="content-wrapper">
    <!-- 
      ‚ö†Ô∏è SECCI√ìN PARA USUARIOS NO AUTENTICADOS
      *ngIf="!user": Solo se muestra cuando NO hay usuario logueado
    -->
    <div *ngIf="!user" class="not-authenticated">
      <ion-card color="warning">
        <ion-card-content>
          <h3>‚ö†Ô∏è No hay usuario autenticado</h3>
          <ion-button expand="block" routerLink="/login">Ir al Login</ion-button>
        </ion-card-content>
      </ion-card>
    </div>

    <!-- 
      üëã SECCI√ìN DE BIENVENIDA
      Muestra saludo personalizado y fecha actual
    -->
    <div class="welcome-section">
      <h1 class="greeting">¬°Hola, {{userName}}!</h1>
      <p class="date">{{currentDate | date:'EEEE, d \'de\' MMMM \'de\' y'}}</p>
    </div>

    <!-- 
      üé≠ SECCI√ìN DE SEGUIMIENTO EMOCIONAL
      Permite al usuario registrar c√≥mo se siente hoy usando emojis
    -->
    <ion-card class="question-card">
      <ion-card-header>
        <ion-card-title class="card-title-small">Tu pregunta del d√≠a</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <p class="question-text">¬øC√≥mo te sientes hoy?</p>

        <div class="emotions-container">
          <ion-button
            [color]="emotionButtons[0].selected ? emotionButtons[0].color : 'medium'"
            [fill]="emotionButtons[0].selected ? 'solid' : 'outline'"
            (click)="toggleEmotion(emotionButtons[0])"
            class="emotion-button"
            size="large">
            <span class="button-content">
              {{emotionButtons[0].emoji}}
              <span class="button-text">{{emotionButtons[0].label}}</span>
            </span>
          </ion-button>

          <ion-button
            [color]="emotionButtons[1].selected ? emotionButtons[1].color : 'medium'"
            [fill]="emotionButtons[1].selected ? 'solid' : 'outline'"
            (click)="toggleEmotion(emotionButtons[1])"
            class="emotion-button"
            size="large">
            <span class="button-content">
              {{emotionButtons[1].emoji}}
              <span class="button-text">{{emotionButtons[1].label}}</span>
            </span>
          </ion-button>

          <ion-button
            [color]="emotionButtons[2].selected ? emotionButtons[2].color : 'medium'"
            [fill]="emotionButtons[2].selected ? 'solid' : 'outline'"
            (click)="toggleEmotion(emotionButtons[2])"
            class="emotion-button"
            size="large">
            <span class="button-content">
              {{emotionButtons[2].emoji}}
              <span class="button-text">{{emotionButtons[2].label}}</span>
            </span>
          </ion-button>

          <ion-button
            [color]="emotionButtons[3].selected ? emotionButtons[3].color : 'medium'"
            [fill]="emotionButtons[3].selected ? 'solid' : 'outline'"
            (click)="toggleEmotion(emotionButtons[3])"
            class="emotion-button"
            size="large">
            <span class="button-content">
              {{emotionButtons[3].emoji}}
              <span class="button-text">{{emotionButtons[3].label}}</span>
            </span>
          </ion-button>

          <ion-button
            [color]="emotionButtons[4].selected ? emotionButtons[4].color : 'medium'"
            [fill]="emotionButtons[4].selected ? 'solid' : 'outline'"
            (click)="toggleEmotion(emotionButtons[4])"
            class="emotion-button"
            size="large">
            <span class="button-content">
              {{emotionButtons[4].emoji}}
              <span class="button-text">{{emotionButtons[4].label}}</span>
            </span>
          </ion-button>
        </div>

        <p class="selection-info" *ngIf="selectedEmotions.length > 0">
          Seleccionadas: {{selectedEmotions.length}} emoci√≥n(es)
        </p>
      </ion-card-content>
    </ion-card>

    <!-- üìä SEPARADOR VISUAL -->
    <div class="divider"></div>

    <!-- 
      üìà SECCI√ìN DE PROGRESO - Seguimiento de h√°bitos
    -->
    <div class="progress-section">
      <h3 class="section-title">Pasos</h3>
      <ion-card class="progress-card">
        <ion-card-header>
          <ion-card-title class="card-title-small">Progreso diario</ion-card-title>
        </ion-card-header>
        <ion-card-content>
          <div class="progress-item">
            <div class="progress-info">
              <ion-icon name="water-outline" color="primary" class="progress-icon"></ion-icon>
              <span class="progress-label">Meta de agua</span>
            </div>
            <div class="progress-value">6/8 vasos</div>
          </div>
        </ion-card-content>
      </ion-card>
    </div>

    <!-- 
      üéØ BOTONES DE ACCI√ìN PRINCIPALES
    -->
    <div class="action-buttons">
      <ion-button expand="block" class="primary-button" (click)="openDailyRegister()">
        Registrar mi d√≠a
      </ion-button>

      <ion-button expand="block" fill="outline" class="secondary-button" routerLink="/indicators">
        Ver mis planes
      </ion-button>
    </div>

    <div class="divider"></div>

    <!-- 
      üí° TARJETA DE CONSEJO DEL D√çA
    -->
    <ion-card class="tip-card">
      <ion-card-header>
        <ion-card-title class="card-title-small">
          <ion-icon name="bulb-outline" color="warning"></ion-icon>
          Consejo del d√≠a
        </ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <p class="tip-text">Recuerda que peque√±os cambios generan grandes resultados. ¬°T√∫ puedes!</p>
      </ion-card-content>
    </ion-card>

    <!-- 
      üìú CONTENIDO EXTRA PARA SCROLL (de prueba)
    -->
    <div class="test-scroll-content">
      <ion-card><ion-card-content><p>Contenido extra 1</p></ion-card-content></ion-card>
      <ion-card><ion-card-content><p>Contenido extra 2</p></ion-card-content></ion-card>
      <ion-card><ion-card-content><p>Contenido extra 3</p></ion-card-content></ion-card>
      <ion-card><ion-card-content><p>Contenido extra 4</p></ion-card-content></ion-card>
      <ion-card><ion-card-content><p>Contenido extra 5</p></ion-card-content></ion-card>
    </div>

    <!-- üìè ESPACIADOR INFERIOR -->
    <div class="bottom-spacer"></div>
  </div>

</ion-content>

<!-- üß≠ COMPONENTE DE MEN√ö/TABS FIJO -->
<app-menu></app-menu>
