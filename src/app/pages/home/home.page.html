<!-- Header especÃ­fico para Home -->
<ion-header>
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-button (click)="openMainMenu()">
        <ion-icon slot="icon-only" name="menu"></ion-icon>
      </ion-button>
    </ion-buttons>

    <ion-title class="logo-title">
      <div class="title-content">
        <!-- Logo igual al del login -->
        <div class="logo-container">
          <div class="logo-image">
            <img 
              src="assets/Nupsi/nupsiLogo.png" 
              alt="NutPsi" 
              class="logo-img"
              (error)="onLogoError()">
          </div>
        </div>
        <span>NutPsi</span>
      </div>
    </ion-title>

    <ion-buttons slot="end">
      <ion-button (click)="openProfileMenu($event)">
        <ion-icon slot="icon-only" name="person-circle-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="home-content" style="--padding-top: 80px; --padding-bottom: 100px;">
  <div class="content-wrapper">
    
    <!-- ============================================
         MENSAJE PARA USUARIOS NO AUTENTICADOS
         ============================================ -->
    <div *ngIf="!user" class="not-authenticated">
      <ion-card>
        <ion-card-header>
          <ion-card-title>Â¡Bienvenido a NutPsi!</ion-card-title>
        </ion-card-header>
        <ion-card-content>
          <p>Inicia sesiÃ³n para comenzar a registrar tu bienestar diario.</p>
          <ion-button expand="block" routerLink="/login" color="primary">
            Iniciar SesiÃ³n
          </ion-button>
        </ion-card-content>
      </ion-card>
    </div>

    <!-- ============================================
         CONTENIDO PARA USUARIOS AUTENTICADOS
         ============================================ -->
    <div *ngIf="user" class="authenticated-content">
      
      <!-- SECCIÃ“N DE BIENVENIDA -->
      <div class="welcome-section">
        <h1 class="greeting">Â¡Hola, {{ userName }}! ðŸ‘‹</h1>
        <p class="date">{{ currentDate | date: 'EEEE, d \'de\' MMMM \'de\' yyyy' }}</p>
      </div>

      <!-- ============================================
           TARJETA: Â¿CÃ“MO TE SIENTES HOY?
           ============================================ -->
      <ion-card class="question-card">
        <ion-card-header>
          <ion-card-title class="card-title-small">Estado Emocional</ion-card-title>
        </ion-card-header>
        <ion-card-content>
          <p class="question-text">Â¿CÃ³mo te sientes hoy?</p>
          
          <div class="emotions-container">
            <ion-button 
              *ngFor="let emotion of emotionButtons"
              [color]="emotion.selected ? emotion.color : 'light'"
              class="emotion-button"
              (click)="toggleEmotion(emotion)"
              [attr.aria-label]="emotion.label"
              [class.selected]="emotion.selected">
              <div class="button-content">
                <span class="emoji">{{ emotion.emoji }}</span>
                <span class="button-text">{{ emotion.label }}</span>
              </div>
            </ion-button>
          </div>

          <p *ngIf="selectedEmotions.length > 0" class="selection-info">
            Has seleccionado: {{ selectedEmotions.join(', ') }}
          </p>
          <p *ngIf="selectedEmotions.length === 0" class="selection-info">
            Selecciona una o mÃ¡s emociones
          </p>
        </ion-card-content>
      </ion-card>

      <!-- ============================================
           TARJETA: HIDRATACIÃ“N
           ============================================ -->
      <ion-card class="question-card">
        <ion-card-header>
          <ion-card-title class="card-title-small">HidrataciÃ³n</ion-card-title>
        </ion-card-header>
        <ion-card-content>
          <p class="question-text">Â¿CuÃ¡ntos vasos de agua has tomado hoy?</p>
          
          <div class="water-tracker">
            <ion-button 
              fill="clear" 
              size="large"
              (click)="decrementarVasosAgua()"
              [disabled]="vasosAgua === 0">
              <ion-icon slot="icon-only" name="remove-circle-outline" size="large"></ion-icon>
            </ion-button>

            <div class="water-count">
              <span class="water-icon">ðŸ’§</span>
              <span class="water-number">{{ vasosAgua }}</span>
              <span class="water-text">/ {{ metaVasosAgua }} vasos</span>
            </div>

            <ion-button 
              fill="clear" 
              size="large"
              (click)="incrementarVasosAgua()"
              [disabled]="vasosAgua >= 20">
              <ion-icon slot="icon-only" name="add-circle-outline" size="large"></ion-icon>
            </ion-button>
          </div>

          <!-- Barra de progreso -->
          <div class="water-progress">
            <div class="progress-bar">
              <div 
                class="progress-fill" 
                [style.width.%]="(vasosAgua / metaVasosAgua) * 100">
              </div>
            </div>
            <p class="progress-text">
              {{ ((vasosAgua / metaVasosAgua) * 100) | number: '1.0-0' }}% de tu meta diaria
            </p>
          </div>
        </ion-card-content>
      </ion-card>

      <!-- ============================================
           SECCIÃ“N DE PROGRESO MEJORADA
           ============================================ -->
      <div *ngIf="usuarioData?.haCompletadoConfiguracionInicial" class="progress-section-improved">
        <h2 class="section-title-improved">
          <ion-icon name="trending-up" class="title-icon"></ion-icon>
          Tu Progreso
        </h2>
        
        <ion-card class="progress-card-improved">
          <ion-card-header class="progress-header">
            <ion-card-title class="card-title-small-improved">Resumen Semanal</ion-card-title>
          </ion-card-header>
          <ion-card-content class="progress-content">
            <div class="progress-items-container">
              <div class="progress-item-improved">
                <div class="progress-info-improved">
                  <div class="icon-wrapper">
                    <ion-icon name="calendar-number" class="progress-icon-improved"></ion-icon>
                  </div>
                  <div class="text-content">
                    <span class="progress-label-improved">Registros esta semana</span>
                    <div class="progress-bar-mini">
                      <div class="progress-fill-mini" [style.width.%]="(5/7)*100"></div>
                    </div>
                  </div>
                </div>
                <span class="progress-value-improved">5/7</span>
              </div>

              <div class="progress-divider"></div>

              <div class="progress-item-improved">
                <div class="progress-info-improved">
                  <div class="icon-wrapper">
                    <ion-icon name="water" class="progress-icon-improved"></ion-icon>
                  </div>
                  <div class="text-content">
                    <span class="progress-label-improved">Meta de hidrataciÃ³n</span>
                    <div class="progress-bar-mini">
                      <div class="progress-fill-mini" [style.width.%]="(vasosAgua/metaVasosAgua)*100"></div>
                    </div>
                  </div>
                </div>
                <span class="progress-value-improved">
                  {{ vasosAgua >= metaVasosAgua ? 'âœ… Completado' : vasosAgua + '/' + metaVasosAgua }}
                </span>
              </div>
            </div>
          </ion-card-content>
        </ion-card>
      </div>

      <!-- ============================================
           BOTONES DE ACCIÃ“N MEJORADOS
           ============================================ -->
      <div class="action-buttons-improved">
        <ion-button 
          *ngIf="!usuarioData?.haCompletadoConfiguracionInicial"
          expand="block" 
          color="primary" 
          class="primary-button-improved"
          (click)="openDailyRegister()">
          <ion-icon slot="start" name="rocket-outline"></ion-icon>
          Comenzar Mi Viaje
        </ion-button>

        <div *ngIf="usuarioData?.haCompletadoConfiguracionInicial" class="action-buttons-group">
          <ion-button 
            expand="block" 
            color="primary" 
            class="primary-button-improved"
            routerLink="/indicators">
            <ion-icon slot="start" name="add-circle"></ion-icon>
            Registro Completo del DÃ­a
          </ion-button>

          <ion-button 
            expand="block" 
            fill="outline" 
            color="primary" 
            class="secondary-button-improved"
            routerLink="/statistics">
            <ion-icon slot="start" name="analytics"></ion-icon>
            Ver Mis EstadÃ­sticas
          </ion-button>
        </div>
      </div>

      <!-- ============================================
           TARJETA DE TIP MOTIVACIONAL MEJORADA
           ============================================ -->
      <ion-card class="tip-card-improved">
        <div class="tip-header-improved">
          <div class="tip-icon-container">
            <ion-icon name="sparkles" class="tip-main-icon"></ion-icon>
          </div>
          <ion-card-header class="tip-card-header">
            <ion-card-title class="card-title-small-improved">
              InspiraciÃ³n del DÃ­a
            </ion-card-title>
          </ion-card-header>
        </div>
        <ion-card-content class="tip-content-improved">
          <p class="tip-text-improved">{{ fraseMotivacional }}</p>
          <div class="tip-decoration">âœ¨</div>
        </ion-card-content>
      </ion-card>

      <!-- ============================================
           PRÃ“XIMAS FUNCIONES MEJORADAS
           ============================================ -->
      <ion-card class="features-card-improved">
        <ion-card-header class="features-header">
          <ion-card-title class="card-title-small-improved">
            <ion-icon name="grid-outline" class="title-icon"></ion-icon>
            PrÃ³ximas Funciones
          </ion-card-title>
        </ion-card-header>
        <ion-card-content class="features-content">
          <div class="features-grid">
            <div class="feature-item-improved" *ngFor="let feature of upcomingFeatures">
              <div class="feature-icon">{{feature.emoji}}</div>
              <span class="feature-text">{{feature.name}}</span>
              <div class="feature-status" [class.coming-soon]="!feature.available">
                {{feature.available ? 'PrÃ³ximo' : 'En desarrollo'}}
              </div>
            </div>
          </div>
        </ion-card-content>
      </ion-card>

      <!-- Espaciador para el menÃº inferior -->
      <div class="bottom-spacer"></div>

    </div>
  </div>
</ion-content>

<!-- ============================================
     FOOTER MENU - MENÃš INFERIOR
     ============================================ -->
<app-menu></app-menu>